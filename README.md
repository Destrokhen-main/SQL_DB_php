# data_base_sql_php
- Library for communicating with the database
- Библиотека упростит работу с вашей базой данных

## Подключение
- Скачайте файл и добавьте его в ваш папку с проектом
- Подключить файл можно с помощью `include("lib_db.php");`
____
## Начало работы
1. Откройте фаил `lib_db.php`
2. В массив `$ardb` запишите данные о ваших базах данных

Вид заполнение массива:
```
[
	"name"		=> "udb",
	"value_db"	=> null,
	"settings"	=> [
				"server"	=> "localhost",
				"username"	=> "",
				"password"	=> "",
				"database"	=> "",
				"port"		=> 3306,
			]
]
```
Где:
* name      -> `string` Название вашей базы (можно выбрать любое)
* value_db  -> `obj` После подключения базы тут будет храниться объект для работы (указывайте `null`)
* settings  -> `array` массив с настройками для подключения (вся информация для подключения есть у вас на хостинге)
	* server 	-> `string` Если код на локальной машине или хостинге, пишите `localhost`
	* username	-> `string` Логин для подключения
	* password	-> `string` Пароль от базы
	* database	-> `string` База к которой будет совершаться подключение
	* port		-> `int` На ваше усмотрение, можете оставить мой порт
____
## Теперь о функциях:

## До того как мы начнём рассматривать функции, немного о том, как к ним обращаться
Всего 1 функция (ПОКА) требуют от вас отправки переменной типа `string`. Это функция `connect_one()`. Остальные же ждут от вас объект. Сейчас покажу как его заполнять:
Для удобства, все поля были записаны через 1-2 буквы.
- Все поля:
```
 "n" (name)  		=> Название базы (string) (в $ardb это name). Если в массиве $ardb есть всего одна запись, можете ничего не писать в 				      * этом пункте
 "t" (table) 		=> Имя таблицы (string)
 "c" (column)		=> Какие поля вы хотите получить (string) (используйте * для получения всех параметров или опишите поля в виде 						      			    "`название поля`,`название поля`")
 "p" (param) 		=> Параметры для сортировки (string). Строка вида ("параметр1 (=,>,<,<>,>=,<=) значения")
 "s" (sort)		=> Параметр сортировки (string). Строка вида (up/down/group:имя поля):
			   *Регистр up / down / group не важен. Так же вы можете писать строку с пробелами (пример: "UP : id")
			   (ВАЖНО): Можно указывать как одно поле, так и несколько (пример: up:id,age).
 "i" (int/string) 	=> id в таблице
 "e" (string)		=> Строка с параметрами на редактирование (string) (вид: "param1 = 1,param2 = 2")
 "ae" (array)		=> массив из параметров редатирования
 "in" (string)		=> поля из таблицы в которую нужно вставить значения
 "v" (array)		=> массив из значений для вставления данных в таблицу 
 "sq" (string)		=> sql запрос 
 "r" (bool)			=> Для получения id при доавбление (aor, amr)
```
- Обращаю ваше внимание, что для некоторых случаев, определенные поля можно не писать. Так же порядок записи полей не влияет на итоговый результат.

- Случаи в которых можно не писать некоторые поля:
```
. Если в массиве $ardb у вас всего одна запись, вы можете не писать (поле "n")
. Если вы хотите получить с запроса все поля, можете не писать (поле "c")
. Если вам не нужно вписывать параметры для сортировки (поле "p"), можете его не писать.
```
- Для вашего удобства, дальше напротив полей который являются обязательными, будет расположен значок `(*)`

- Пример заполнения:
```
[
	"n" => "text",
	"t" => "text"
]
```

## 1. `connect_all()` - подключение баз данных (cоздаст подключение к базам из массива $ardb)
  _Перед вызовом функции Обязательно заполните $ardb_
____
## 2. `connect_one()` - Подключит одну базы
 _Перед вызовом функции Обязательно заполните $ardb_
* Входные параметры:
	* 1 Имя базы - `string` в `$ardb` это `name`
   
### Пример:
* `connect_one("udb")`
____    
## 3. `gor()` - вернёт вам одну запись:
```
Входные параметры:
	"n" (name) 	- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t" (table) 	- Имя таблицы (string)
	(*)"p" (param) 	- Параметры для сортировки (string). Строка вида ("параметр1 (=,>,<,<>,>=,<=) значения")
	"c" (column) 	- Какие поля вы хотите получить (string) (пример для нескольких полей "`название поля`,`название поля`")
```    
### Пример:
* -> `gor(["t"=> "user","p" => "id = 3"]);`
* <- `obj or false` В ответе получим объект (в случае ошибки вернёт `false`)
_____
## 4. `gmr()` - вернёт массив из объектов
```
Входные параметры
	"n" (name) 		- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t" (table)		- Имя таблицы (string)
	"p" (param)		- Параметры для сортировки (string). Строка вида ("параметр1 (=,>,<,<>,>=,<=) значения")
	"c" (column)		- Какие поля вы хотите получить (string) (пример для нескольких полей "`название поля`,`название поля`")
	"s" (sort)		- Параметр сортировки (string). Для удобства имеет вид "вид сортировки(up / down / group:поля по которому будет сортировка (может быть несколько))". Описание сортировок: (регистр неважен) up - по убыванию , down - по возрастанию , group - группировка по полю . Для того, чтобы отсортированить по нескольким параметрам, используйте "," пример: id,age,year. 
	
```
### Пример:
* -> `gmr(["t"=>'user']);`
* <- `obj or false` Вернёт  массив объектов (в случае ошибки вернёт `false`)

* -> `gmr(["t"=>'user',"s"=>"up:id"])`
* <- `obj or false` Вернёт массив объектов отсортированный в порядке убывания (в случаи ошибки вернёт `false`)
____  
## 5. `dor()` - Удалит запись с вашей базы
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t"			- Название таблицы (string)
	(*)"i"			- id в таблице (int or string)
```    
### Пример:
* -> `dor(["t"=>"user","i"=>3]);`
* <- `true or false` Если удаление прошло успешно - вернёт true (при возникновение ошибки `false`)
____  
## 6. `dmr()` - удаление нескольких записей
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t"			- Название таблицы (string)
	(*)"a"			- массив из id в таблице (int or string)
```  
### Пример:
* -> `dmr(["t"=>"user","a"=>[1,2,3,4]]);`
* <- `true or false` Если удаление прошло успешно - вернёт `true` (при возникновение ошибки при удалении какого-то объекта из массива вернёт `false`)

## 7. `eor()` - редактирование записи в базе данных
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t"			- Название таблицы (string)
	(*)"e"			- Строка с параметрами на редактирование (string) (вид: "param1 = 1,param2 = 2")
	(*)"p"			- Параметры для редактирования (string) (вид "id = 3 (and/or/not) id = 5")
```  
### Пример:
* -> `eor(["t"=>"user","e"=>"name='ivan', age = 17","p"=>"id=3"]);`
* <- `true or false` : `true` - если редактирование прошло успешно и `false` если нет
____ 

## 8. emr() - Отредактирует несколько записей
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name) (ЕСЛИ В $ardb НЕСКОЛЬКО ЗАПИСЕЙ ЭТОТ ПАРАМЕТР ЯВЛЯЕТСЯ ОБЯЗАТЕЛЬНЫМ)  
	(*)"t"			- Название таблицы (string)
	(*)"ae"			- массив с параметрами
```
Вид: 
```
"ae" => [
		[
            		"ep"  => "Какие поля меняем (id = 4 , param = value)",
            		"pe" => "Где меняем (id = 3 (and/or/not) id = 7) "
		]
	]
```
### Пример:
* -> 
```
eor(["t"=>"user","ae"=>[
				[
					"ep" => "name = 'ivan', age = 17",
					"pe" => "id = 7"
				],
				[
					"ep" => "name = 'vasya'",
					"pe" => "id = 8"
				]
			]])
```
* <- `true or false` : `true` - если редактирование прошло успешно и `false` если нет
____
## 9. aor() - Добавит запись в таблицу
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name).
	(*)"t"			- Название таблицы (string)
	(*)"p"			- (string) строка с параметрами вида "названия колонки:данные,название колонки:дата".
					  Пример: "id@=NULL@,name@=Ivan@,Age@=17"
	"r"			- (bool) Вернёт вам id созданого элемента с базы данных (Если вы укажите этот параметр, ответ поменяется)
```

### Пример:
* -> aor("user","id@=NULL@,name@=Ivan");
* <- `true or false` : `true` - если добавление прошло успешно и `false` если нет.

В случаи если был указан "r" параметр 
* -> aor("user","id@=NULL@,name@=Ivan","r"=>true);
* <- Вернёт массив ["status","id"]
"status" - true или false
"id"	 - Будет доступен в случаи если status = true
____

## 10. amr() - Добавит несколько записей в таблицу
```
Входные параметры:
	"n" (name) 		- Название базы (string) (в $ardb это name).
	(*)"t"			- Название таблицы (string)
	(*)"in"			- Поля в таблице (string). Вид: ("`name`,`age`,`year`");
	(*)"v"			- Значения для полей выше. Вид: ["'ivan',17,1999","'max',18,1998"]
	"r"			- (bool) Вернёт вам id созданого элемента с базы данных (Если вы укажите этот параметр, ответ поменяется)
``` 
### Пример:
* -> amr("user","`id`,`name`,`year`",["'ivan',17,1999","'vanya',18,1998"]);
* <- `true or false` : `true` - если добвление прошло успешно и `false` если нет.

В случаи если был указан "r" параметр 
* -> aor("user","`id`,`name`,`year`",["'ivan',17,1999","'vanya',18,1998"],"r"=>true);
* <- Вернёт массив ["status","id"]
"status" - true или false
"id"	 - Будет доступен массив из id в случаи если status = true. Если во время добавления где-то произошла ошибка например в середине добавления, id записей до этого элемента в случаи успешного добавления будут доступны при статусе false 
____
## 11. sql() - Выполнить ваш SQL запрос
```
Входные параметры:
	"n"	- Название базы (string) (в $ardb это name).
	"sq"- Запрос SQL (string)
```

### Пример:
* -> ```sql(["sq"=> "SELECT * FROM `table` WHERE id = 3"])```
* <- true or false or obj - Ответ от запроса. 

## Обработка ошибок:
* В некоторых ситуациях с получением статуса `true` или `false` вам может вернуться текстовое оповещение (Отображается в браузере)
* Текст ошибки поможет разобраться в местах проблемного кода (но это не факт, так что проверяйте прежде чем начинать работу)

*Важно* Если вы не хотите выводить сообщение об ошибках, измените переменную `$debag` на `false` (по умолчанию стоит `true`)
  
## Пример использования в коде:
```
<?php
  include("lib_db.php"); // подключаем файл
  
  connect_all() // подключаем все базы
  
  echo gor(["n"=>"user","p"=>"age = 17"])
 
  Ответ : [{"0":"1","id":"1"}]
?>
```